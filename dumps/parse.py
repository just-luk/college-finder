import re

intro = """DROP TABLE IF EXISTS `colleges`;

CREATE TABLE `colleges` (
    `unitid` bigint NOT NULL,
    `name` text,
    `year` double DEFAULT NULL,
    `studentLevel` double DEFAULT NULL,
    `studentsEnrolled` double DEFAULT NULL,
    `studentsEnrolledOnlyDistance` double DEFAULT NULL,
    `studentsEnrolledSomeDistance` double DEFAULT NULL,
    `studentEnrolledNoDistance` double DEFAULT NULL,
    `idx_ef` double DEFAULT NULL,
    `occupationAndFullTimeStatus` double DEFAULT NULL,
    `grandTotal` double DEFAULT NULL,
    `grandTotalMen` double DEFAULT NULL,
    `grandTotalWomen` double DEFAULT NULL,
    `americanIndianTotal` double DEFAULT NULL,
    `americanIndianTotalMen` double DEFAULT NULL,
    `americanIndianTotalWomen` double DEFAULT NULL,
    `asianTotal` double DEFAULT NULL,
    `asianMen` double DEFAULT NULL,
    `asianWomen` double DEFAULT NULL,
    `blackTotal` double DEFAULT NULL,
    `blackTotalMen` double DEFAULT NULL,
    `blackTotalWomen` double DEFAULT NULL,
    `hispanicTotal` double DEFAULT NULL,
    `hispanicTotalMen` double DEFAULT NULL,
    `hispanicTotalWomen` double DEFAULT NULL,
    `pacificIslanderTotal` double DEFAULT NULL,
    `pacificIslanderTotalMen` double DEFAULT NULL,
    `pacificIslanderTotalWomen` double DEFAULT NULL,
    `whiteTotal` double DEFAULT NULL,
    `whiteTotalMen` double DEFAULT NULL,
    `whiteTotalWomen` double DEFAULT NULL,
    `twoOrMoreTotal` double DEFAULT NULL,
    `twoOrMoreTotalMen` double DEFAULT NULL,
    `twoOrMoreTotalWomen` double DEFAULT NULL,
    `raceUnknownTotal` double DEFAULT NULL,
    `raceUnknownMen` double DEFAULT NULL,
    `raceUnknownWomen` double DEFAULT NULL,
    `nonresidentTotal` double DEFAULT NULL,
    `nonresidentTotalMen` double DEFAULT NULL,
    `nonresidentTotalWomen` double DEFAULT NULL,
    `idx_hr` double DEFAULT NULL,
    `foreigners` double DEFAULT NULL,
    `percentAdmitted` double DEFAULT NULL,
    `percentAdmittedMen` double DEFAULT NULL,
    `percentAdmittedWomen` double DEFAULT NULL,
    `admissionsYield` double DEFAULT NULL,
    `admissionsYieldMen` double DEFAULT NULL,
    `admissionsYieldWomen` double DEFAULT NULL,
    `alias` text,
    `address` text,
    `city` text,
    `state` text,
    `zip` text,
    `telephone` double DEFAULT NULL,
    `website` text,
    `financialAidSite` text,
    `admissionsSite` text,
    `applicationSite` text,
    `netPriceSite` text,
    `openToPublic` text,
    `isActive` text,
    `sector` text,
    `hospital` text,
    `hbcu` text,
    `tribalCollege` text,
    `openAdmissions` text,
    `degreeOfUrbanization` text,
    `titleIndicator` text,
    `lessThanOneYear` text,
    `lessThanTwelveWeeks` double DEFAULT NULL,
    `betweenTwelveWeeksAndYear` double DEFAULT NULL,
    `betweenOneAndTwoYear` text,
    `associateDegree` double DEFAULT NULL,
    `betweenTwoAndFourYear` text,
    `bachelorDegree` double DEFAULT NULL,
    `postbaccalaureateCertificate` text,
    `masterDegree` double DEFAULT NULL,
    `postMaster` text,
    `doctorResearchAndScholarship` double DEFAULT NULL,
    `doctorProfessionalPractice` double DEFAULT NULL,
    `doctorOther` double DEFAULT NULL,
    `otherDegree` text,
    `naa` text,
    `ncaa` text,
    `naia` text,
    `njcaa` text,
    `nscaa` text,
    `nccaa` text,
    `otherAthleticAssociation` text,
    `missionStatement` text,
    `missionStatementUrl` text,
    `dualEnrollment` text,
    `creditForLifeExperiences` text,
    `apCredits` text,
    `noCredits` text,
    `rotc` text,
    `studyAbroad` text,
    `weekendOrEveningCollege` text,
    `remedialServices` text,
    `careerOrAcademicService` text,
    `studentEmployment` text,
    `placementServices` text,
    `noServices` text,
    `noDistanceEducation` text,
    `percentDisabilities` text,
    `prepaidTuition` text,
    `undergradApplicationFee` text,
    `gradApplicationFee` text,
    `tuitionVaries` text,
    `onCampusRequired` text,
    `housingProvided` text,
    `boardProvided` text,
    `numberOfPrograms` text,
    `undergradDistrictTuition` text,
    `undergradStateTuition` double DEFAULT NULL,
    `undergradOutOfStateTuition` double DEFAULT NULL,
    `gradDistrictTuition` text,
    `gradStateTuition` text,
    `gradOutOfStateTuition` text,
    `districtPrice` double DEFAULT NULL,
    `statePrice` double DEFAULT NULL,
    `outOfStatePrice` double DEFAULT NULL,
    `suppliesCost` double DEFAULT NULL,
    `roomAndBoard` double DEFAULT NULL,
    `totalUndergradStudents` double DEFAULT NULL,
    `fullTimeCohort` double DEFAULT NULL,
    `sizeCategory` text,
    `totalEnrollment` text,
    `undergradEnrollment` text,
    `gradEnrollment` text,
    `totalPercentAmericanIndian` double DEFAULT NULL,
    `totalPercentAsian` text,
    `totalPercentBlack` double DEFAULT NULL,
    `totalPercentHispanic` text,
    `totalPercentPacificIslander` text,
    `totalPercentWhite` double DEFAULT NULL,
    `totalPercentTwoOrMore` double DEFAULT NULL,
    `totalPercentUnknown` double DEFAULT NULL,
    `totalPercentNonresident` double DEFAULT NULL,
    `totalPercentAsianOrPacificIslander` double DEFAULT NULL,
    `totalPercentWomen` double DEFAULT NULL,
    `undergradPercentAmericanIndian` double DEFAULT NULL,
    `undergradPercentAsian` double DEFAULT NULL,
    `undergradPercentBlack` double DEFAULT NULL,
    `undergradPercentHispanic` double DEFAULT NULL,
    `undergradPercentPacificIslander` double DEFAULT NULL,
    `undergradPercentWhite` double DEFAULT NULL,
    `undergradPercentTwoOrMore` double DEFAULT NULL,
    `undergradPercentUnknown` double DEFAULT NULL,
    `undergradPercentNonresidentAlien` double DEFAULT NULL,
    `undergradPercentAsianOrPacificIslander` double DEFAULT NULL,
    `undergradPercentWomen` double DEFAULT NULL,
    `gradPercentAmericanIndian` double DEFAULT NULL,
    `gradPercentAsian` double DEFAULT NULL,
    `gradPercentBlack` double DEFAULT NULL,
    `gradPercentHispanic` double DEFAULT NULL,
    `gradPercentPacificIslander` double DEFAULT NULL,
    `gradPercentWhite` double DEFAULT NULL,
    `gradPercentTwoOrMore` double DEFAULT NULL,
    `gradPercentUnknown` double DEFAULT NULL,
    `gradPercentNonresident` double DEFAULT NULL,
    `gradPercentAsianOrPacificIslander` double DEFAULT NULL,
    `gradPercentWomen` double DEFAULT NULL,
    `studentToFaculty` double DEFAULT NULL,
    `undergradPercentDisabilities` text,
    `certificatesLessThanYear` double DEFAULT NULL,
    `certificatesBetweenOneAndTwo` double DEFAULT NULL,
    `certificatesBetweenTwoAndFour` double DEFAULT NULL,
    `postbaccalaureateCertificates` double DEFAULT NULL,
    `postMasterCertificates` double DEFAULT NULL,
    `totalExpensesGASB` double DEFAULT NULL,
    `instructionExpensesGASB` double DEFAULT NULL,
    `researchExpensesGASB` double DEFAULT NULL,
    `serviceExpensesGASB` double DEFAULT NULL,
    `academicSupportGASB` double DEFAULT NULL,
    `studentServiceGASB` double DEFAULT NULL,
    `institutionalSupportGASB` double DEFAULT NULL,
    `otherExpensesGASB` double DEFAULT NULL,
    `instructionExpensesFASB` double DEFAULT NULL,
    `researchExpensesFASB` double DEFAULT NULL,
    `serviceExpensesFASB` double DEFAULT NULL,
    `academicSupportExpensesFASB` double DEFAULT NULL,
    `studentServiceExpensesFASB` double DEFAULT NULL,
    `institutionalSupportExpensesFASB` double DEFAULT NULL,
    `otherExpensesFASB` double DEFAULT NULL,
    `instructionExpensesForProfit` double DEFAULT NULL,
    `researchExpensesForProfit` double DEFAULT NULL,
    `servicesExpensesForProfit` double DEFAULT NULL,
    `academicSupportExpensesForProfit` double DEFAULT NULL,
    `studentServiceExpensesForProfit` double DEFAULT NULL,
    `institutionalSupportExpensesForProfit` double DEFAULT NULL,
    `endowmentPerFteEnrollmentGASB` double DEFAULT NULL,
    `endowmentPerFteEnrollmentFASB` double DEFAULT NULL,
    `undergradTotalWithFinancialAid` double DEFAULT NULL,
    `undergradPercentAidAwarded` double DEFAULT NULL,
    `undergradTotalAid` double DEFAULT NULL,
    `undergradAverageAid` double DEFAULT NULL,
    `averagePriceWithAid` double DEFAULT NULL,
    `graduationRateTotal` double DEFAULT NULL,
    `graduationRateMen` double DEFAULT NULL,
    `graduationRateWomen` double DEFAULT NULL,
    `graduationRateFourYears` double DEFAULT NULL,
    `graduationRateFiveYears` double DEFAULT NULL,
    `graduationRateSixYears` double DEFAULT NULL,
    `tuitionAndFees` double DEFAULT NULL,
    `stateAbbreviation` text,
    `institutionalCategory` text,
    `retentionRate` double DEFAULT NULL,
    `undergradPercentState` double DEFAULT NULL,
    `undergradPercentOutOfState` double DEFAULT NULL,
    `undergradPercentForeign` double DEFAULT NULL,
    `undergradPercentResidenceUnknown` double DEFAULT NULL,
    `percentOnlyDistance` double DEFAULT NULL,
    `percentSomeDistance` double DEFAULT NULL,
    `percentNoDistance` double DEFAULT NULL,
    `undergradPercentOnlyDistance` double DEFAULT NULL,
    `undergradPercentSomeDistance` double DEFAULT NULL,
    `undergradPercentNoDistance` double DEFAULT NULL,
    `gradPercentOnlyDistance` double DEFAULT NULL,
    `gradPercentSomeDistance` double DEFAULT NULL,
    `gradPercentNoDistance` double DEFAULT NULL,
    `graduationRateWithinNormalTime` double DEFAULT NULL,
    `undergradPercentFinancialAid` double DEFAULT NULL,
    `undergradPercentGrantAid` double DEFAULT NULL,
    `averageAid` double DEFAULT NULL,
    `percentAwardFourYears` double DEFAULT NULL,
    `percentAwardSixears` double DEFAULT NULL,
    `percentAwardEightyYears` double DEFAULT NULL,
    `percentCertificateEightyears` double DEFAULT NULL,
    `percentAssociateEightyears` double DEFAULT NULL,
    `percentBachelorEightyears` double DEFAULT NULL,
    `totalFteStaff` double DEFAULT NULL,
    `instructionalResearchAndServiceFte` double DEFAULT NULL,
    `instructionalFte` double DEFAULT NULL,
    `researchFte` double DEFAULT NULL,
    `publicServiceFte` double DEFAULT NULL,
    `managementFte` double DEFAULT NULL,
    `financialFte` double DEFAULT NULL,
    `computerEngineeringAndScienceFte` double DEFAULT NULL,
    `communityServiceLegalAndArtsFte` double DEFAULT NULL,
    `healthcareFte` double DEFAULT NULL,
    `serviceFte` double DEFAULT NULL,
    `salesFte` double DEFAULT NULL,
    `officeFte` double DEFAULT NULL,
    `naturalResourcesConstructionMaintenanceFte` double DEFAULT NULL,
    `productionTransportationMaterialMovingFte` double DEFAULT NULL,
    `secondaryGpa` text,
    `secondaryRank` text,
    `secondaryRecord` text,
    `completionOfPrepProgram` text,
    `recommendations` text,
    `formalDemonstrationOfCompetencies` text,
    `admissionTestScores` text,
    `otherTest` text,
    `toefl` text,
    `applicantsTotal` double DEFAULT NULL,
    `applicantsMen` double DEFAULT NULL,
    `applicantsWomen` double DEFAULT NULL,
    `enrolledTotal` double DEFAULT NULL,
    `enrolledMen` double DEFAULT NULL,
    `enrolledWomen` double DEFAULT NULL,
    `percentAdmittedTotal` double DEFAULT NULL,
    `admissionsYieldTotal` double DEFAULT NULL,
    `percentSatSubmits` double DEFAULT NULL,
    `percentActSubmits` double DEFAULT NULL,
    `satEnglish25th` double DEFAULT NULL,
    `satEnglish75th` double DEFAULT NULL,
    `satMath25th` double DEFAULT NULL,
    `satMath75th` double DEFAULT NULL,
    `actComposite25th` double DEFAULT NULL,
    `actComposite75th` double DEFAULT NULL,
    `actEnglish25th` double DEFAULT NULL,
    `actEnglish75th` double DEFAULT NULL,
    `actMath25th` double DEFAULT NULL,
    `actMath75th` double DEFAULT NULL,
    `totalLibraryCollection` double DEFAULT NULL,
    `tenureStatus` double DEFAULT NULL,
    `totalEmployees` double DEFAULT NULL,
    `stateOfResidenceWhereFirstAdmitted` text,
    `totalUndergraduateStudents` double DEFAULT NULL,
    `notReportedResidence` double DEFAULT NULL,
    `outlyingAreas` double DEFAULT NULL,
    PRIMARY KEY (`unitid`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci;
"""

def split_string(s):
    inside_quotes = False
    output_data = []
    word = ""
    for index, c in enumerate(s):
        if (c == '"' or c== "'") and s[index-1] != '\\':
            inside_quotes = not inside_quotes

        if not inside_quotes:
            if c == ',':
                output_data.append(word)
                word = ""
            else:
                word += c
        else:
            word += c
    output_data.append(word)
    return output_data

with open('dumps/dump.sql', 'r') as r:
    lines = r.readlines()

to_remove = []
for index, line in enumerate(lines):
    if "2`" in line:
        to_remove.append(index - 1)


new_lines = []
for i in range(320, 322):
    data_points = lines[i].split('),(')
    first_part = data_points[0][:31]
    data_points[0] = data_points[0][31:]
    data_points[-1] = data_points[-1][:-2]
    new_data_points = []
    for point in data_points[:-1]:
        split_point = split_string(point)
        new_point = []
        for i in range(len(split_point)):
            if i not in to_remove:
                new_point.append(split_point[i])
        joined_string = ','.join(new_point)
        new_data_points.append(joined_string)
    new_data_points[0] = first_part + new_data_points[0]
    new_data_points[-1] = new_data_points[-1] + ');\n'
    new_line = '),('.join(new_data_points) + '\n'
    new_lines.append(new_line)

with open('dumps/dump_fixed.sql', 'w') as w:
    for line in new_lines:
        w.write(line)
